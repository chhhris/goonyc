<div class="body">
  <h1>Flights Dashboard</h1><span>

  <div class="refresh">
    <form action="/refresh" accept-charset="UTF-8" method="post">
      <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
      <div class="actions">
        <button type="submit">Refresh flights</button>
      </div>
    </form>
  </div>

  <table class="flightsTable">
    <tr>
      <th style="width: 15%;">Select</th>
      <th style="width: 35%;">Destination</th>
      <th style="width: 15%;">Price</th>
      <th style="width: 20%;">Weekend</th>
      <th style="width: 15%;">URL</th>
    </tr>
    <% @trips.each_with_index do |trip, index| %>
      <%
          departure_date = "#{trip.depart_at.strftime('%B').downcase} #{trip.depart_at.strftime('%e').downcase}"
          return_date = trip.return_at.strftime('%e')
          return_date.prepend("#{trip.return_at.strftime('%B').downcase} ") if trip.return_at.strftime('%B') != trip.depart_at.strftime('%B')
          # TODO
          # return_date = format_return(trip.return_at)
      %>
      <tr class="<%= trip.featured? ? 'featuredRow' : "#{index.odd?}Row" %>">
        <td>
          <% if trip.featured? %>
            <b>Featured</b>
          <% else %>
            <form action="/select" accept-charset="UTF-8" method="post">
              <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
              <input type="hidden" name="trip_id" value="<%= trip.id %>">
              <div class="actions">
                <button type="submit">Select</button>
              </div>
            </form>
          <% end %>
        </td>
        <td><%= trip.name %></td>
        <td><%= "$#{sprintf("%.0f", trip.price)}" %></td>
        <td><%= departure_date %>-<%= return_date %></td>
        <td><a href="<%= trip.url %>" target="_blank">Link</a></td>
      </tr>
    <% end %>
  </table>
</div>

<!--

  # View

  [[ refresh data ]]

t = Trip.new(destination_code: 'CUN', departure: 15.days.from_now, return: 18.days.from_now, price: '420.27', url: 'http://example.com', featured: false)

  Destination    Code            Departure       Return          Price     Selected
  ===========    =============   =============   =============   =======   =========
  Bahamas        STT             Nov 4           Nov 4           $260      true
  Turks          POS             Oct 14          Oct 14          $325      false
  St. Thomas     CUN             Nov 10          Nov 10          $410      false


    #destination
    def lowest_price
      self.prices.order(price DESC).first
    end

  # Destinations Table
  ## has_many prices

  id  destination   bg_img    sm_img    selected


  # Prices Table
  ## belongs_to destination

  depart  return  destination_id  price



  # 6 weeks x iterations
    Thurs - Sun,
    Fri - Mon

  trips = [
    { depart: '', return: '' },
    { depart: '', return: '' },
    { depart: '', return: '' },
    { depart: '', return: '' },
    { depart: '', return: '' },
    { depart: '', return: '' }
  ]
 -->
